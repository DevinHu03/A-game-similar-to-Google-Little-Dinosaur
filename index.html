<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width,initial-scale=1.0" />
	<title>Dino Runner / 小恐龙跑酷</title>
	<style>
		:root {
			--bg-day-top:#9ad9ff;
			--bg-day-bottom:#e8f9ff;
			--bg-night-top:#0c1730;
			--bg-night-bottom:#1a2f55;
			--accent:#4caf50;
			--accent-alt:#ffb300;
			--danger:#e74c3c;
			--panel-bg:rgba(255,255,255,.88);
			--panel-bg-dark:rgba(30,40,60,.9);
			--text-dark:#1e2732;
			--text-light:#f5f7fa;
			--radius:18px;
			--transition:0.3s cubic-bezier(.4,.0,.2,1);
			font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'PingFang SC','Hiragino Sans GB','Microsoft YaHei',sans-serif;
		}
		*{box-sizing:border-box;margin:0;padding:0;-webkit-user-select:none;user-select:none}
		body{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(var(--bg-day-top),var(--bg-day-bottom));overflow:hidden;transition:background 1.5s linear;font-size:16px;color:var(--text-dark);}
		body.night{background:linear-gradient(var(--bg-night-top),var(--bg-night-bottom));}
		#game-shell{width:100%;max-width:940px;aspect-ratio:16/9;position:relative;border-radius:var(--radius);overflow:hidden;box-shadow:0 20px 50px -10px rgba(0,0,0,.45),0 0 0 2px rgba(255,255,255,.15) inset;background:linear-gradient(#ffffff,#f6f9fc);}
		body.night #game-shell{background:linear-gradient(#142236,#233955);}    
		canvas#game{width:100%;height:100%;display:block;image-rendering:pixelated;}
		/* Overlay panels */
		.overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;pointer-events:none;}
		.panel{pointer-events:auto;-webkit-backdrop-filter:blur(18px) saturate(160%);backdrop-filter:blur(18px) saturate(160%);background:var(--panel-bg);border:1px solid rgba(255,255,255,.6);box-shadow:0 10px 30px -5px rgba(0,0,0,.25);padding:34px 42px;border-radius:calc(var(--radius) - 4px);max-width:520px;width:min(92%,520px);text-align:center;animation:fadeSlide .6s var(--transition);}
		body.night .panel{background:var(--panel-bg-dark);border:1px solid rgba(255,255,255,.12);color:var(--text-light);}    
		.panel h1{font-size:2.4rem;letter-spacing:.03em;line-height:1.15;margin-bottom:1rem;background:linear-gradient(90deg,var(--accent),var(--accent-alt));-webkit-background-clip:text;background-clip:text;color:transparent;}
		.panel p{opacity:.8;line-height:1.4;margin:.2rem 0 1.2rem;}
		.btn-row{display:flex;gap:14px;flex-wrap:wrap;justify-content:center;}
		button{font:600 1rem/1 inherit;padding:12px 28px;border-radius:1000px;cursor:pointer;border:none;position:relative;overflow:hidden;background:linear-gradient(135deg,var(--accent) 0%,#2d8740 100%);color:#fff;letter-spacing:.5px;box-shadow:0 6px 16px -4px rgba(0,0,0,.4);transition:var(--transition);}
		button:hover{transform:translateY(-3px);box-shadow:0 10px 22px -6px rgba(0,0,0,.55);}
		button:active{transform:translateY(1px);}
		button.alt{background:linear-gradient(135deg,#607d8b,#415a64);}    
		button.warn{background:linear-gradient(135deg,#ff7043,#d84315);}    
		button.outline{background:transparent;color:var(--accent);border:2px solid var(--accent);box-shadow:none;}
		body.night button.outline{color:var(--accent-alt);border-color:var(--accent-alt);}
		button.outline:hover{background:var(--accent);color:#fff;}
		body.night button.outline:hover{background:var(--accent-alt);}
		.lang-switch{position:absolute;top:14px;left:14px;display:flex;gap:8px;z-index:20;}
		.lang-switch button{padding:6px 14px;font-size:.8rem;box-shadow:0 4px 10px -3px rgba(0,0,0,.4);}
		.lang-switch button.active{background:var(--accent-alt);}
		#hud{position:absolute;top:12px;right:14px;display:flex;flex-direction:column;align-items:flex-end;gap:6px;font-feature-settings:"tnum" 1;}
		#hud span{font-weight:600;font-size:1rem;padding:4px 12px;border-radius:8px;background:rgba(255,255,255,.6);-webkit-backdrop-filter:blur(6px);backdrop-filter:blur(6px);}
		body.night #hud span{background:rgba(30,40,60,.65);color:var(--text-light);}    
		#messages{position:absolute;left:50%;top:72%;transform:translate(-50%,-50%);font-size:1.1rem;font-weight:600;padding:8px 22px;background:rgba(0,0,0,.55);color:#fff;border-radius:40px;letter-spacing:1px;opacity:0;pointer-events:none;transition:.4s;}
		#messages.show{opacity:1;top:66%;}
		.hidden{display:none !important;}
		/* Progress bar (speed / difficulty) */
		#difficulty{position:absolute;bottom:10px;left:50%;width:60%;max-width:420px;height:8px;transform:translateX(-50%);background:rgba(255,255,255,.5);border-radius:8px;overflow:hidden;box-shadow:0 2px 6px -2px rgba(0,0,0,.4);}
		body.night #difficulty{background:rgba(255,255,255,.15);}    
		#difficulty .fill{height:100%;width:0;background:linear-gradient(90deg,var(--accent) 0%,var(--accent-alt) 100%);transition:width .3s;}
		/* Mobile hint */
		#touch-hint{position:absolute;bottom:14px;right:14px;background:rgba(0,0,0,.5);color:#fff;padding:8px 14px;font-size:.7rem;border-radius:12px;letter-spacing:.5px;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);display:none;}
		/* Inline style replacements */
		.fps-indicator{opacity:.55;font-weight:500;font-size:.7rem;}
		.tip-note{margin-top:1.2rem;font-size:.8rem;opacity:.65}
		@media (max-width:900px){#touch-hint{display:block;} .panel h1{font-size:1.9rem;} button{padding:12px 24px;} }
		@media (max-width:580px){#game-shell{aspect-ratio:10/16;} #difficulty{width:78%;}}
		/* Animations */
		@keyframes fadeSlide{from{opacity:0;transform:translateY(30px) scale(.94);}to{opacity:1;transform:translateY(0) scale(1);} }
		/* Accessibility focus */
		button:focus-visible{outline:3px solid var(--accent-alt);outline-offset:2px;}
	</style>
</head>
<body>
	<div id="game-shell">
		<canvas id="game"></canvas>
		<div id="hud" class="hidden">
			<span id="score-label">Score: <b id="score">0</b></span>
			<span id="high-label">High: <b id="high">0</b></span>
			<span id="fps" class="fps-indicator">FPS</span>
		</div>
		<div id="difficulty" class="hidden"><div class="fill"></div></div>
		<div id="messages"></div>
		<div class="lang-switch">
			<button data-lang="zh" class="active" aria-label="切换到中文">中文</button>
			<button data-lang="en" aria-label="Switch to English">EN</button>
		</div>
		<!-- Start Panel -->
		<div id="start-overlay" class="overlay">
			<div class="panel" id="start-panel">
				<h1 id="title-text">小恐龙跑酷</h1>
				<p id="subtitle-text">按【空格 / ↑】或点下面按钮开始</p>
				<div class="btn-row">
					<button id="start-btn">Start</button>
					<button id="toggle-theme" class="outline">🌙</button>
				</div>
			<p id="tip-text" class="tip-note">
					Made with Canvas • 支持离线 • Multi‑Language
				</p>
			</div>
		</div>
		<!-- Pause Panel -->
		<div id="pause-overlay" class="overlay hidden">
			<div class="panel" id="pause-panel">
				<h1 id="pause-title">已暂停</h1>
				<p id="pause-desc">再按一次继续游戏</p>
				<div class="btn-row">
					<button id="resume-btn">▶</button>
					<button id="restart-btn" class="alt">⟳</button>
					<button id="quit-btn" class="warn">✕</button>
				</div>
			</div>
		</div>
		<!-- Game Over Panel -->
		<div id="over-overlay" class="overlay hidden">
			<div class="panel" id="over-panel">
				<h1 id="over-title">游戏结束</h1>
				<p id="over-score-line">分数: 0 | 最高: 0</p>
				<div class="btn-row">
					<button id="again-btn">Again</button>
					<button id="share-btn" class="outline">Share</button>
					<button id="over-quit-btn" class="warn">Exit</button>
				</div>
			</div>
		</div>
		<div id="touch-hint">Tap 左/右 半屏 = 跳 / 下蹲 (hold)</div>
	</div>
	<script>
	(()=>{
		/* ================= I18N ================= */
		const i18n = {
			en:{
				title:"Dino Runner",
				subtitle:"Press [SPACE / ↑] or tap to start",
				start:"Start",
				paused:"Paused",
				pauseDesc:"Press resume or SPACE to continue",
				resume:"Resume",
				restart:"Restart",
				quit:"Quit",
				gameOver:"Game Over",
				scoreLine:(s,h)=>`Score: ${s} | High: ${h}`,
				again:"Play Again",
				share:"Share",
				exit:"Exit",
				tip:"Made with Canvas • Offline Ready • Multi‑Language",
				score:"Score",
				high:"High",
				newHigh:"NEW HIGH SCORE!",
				speedUp:"Speed Up!",
				perfect:"Nice!",
				day:"Day",night:"Night"
			},
			zh:{
				title:"小恐龙跑酷",
				subtitle:"按【空格 / ↑】或点击开始",
				start:"开始",
				paused:"已暂停",
				pauseDesc:"按继续或空格恢复",
				resume:"继续",
				restart:"重开",
				quit:"退出",
				gameOver:"游戏结束",
				scoreLine:(s,h)=>`分数: ${s} | 最高: ${h}`,
				again:"再来一次",
				share:"分享",
				exit:"退出",
				tip:"Canvas 制作 • 支持离线 • 多语言",
				score:"分数",
				high:"最高",
				newHigh:"新纪录！",
				speedUp:"加速！",
				perfect:"漂亮！",
				day:"白昼",night:"夜晚"
			}
		}
		let lang='zh';
		const $=sel=>document.querySelector(sel);
		const $$=sel=>[...document.querySelectorAll(sel)];
		function applyLang(){
			const t=i18n[lang];
			$('#title-text').textContent=t.title;
			$('#subtitle-text').textContent=t.subtitle;
			$('#start-btn').textContent=t.start;
			$('#pause-title').textContent=t.paused;
			$('#pause-desc').textContent=t.pauseDesc;
			$('#resume-btn').textContent=t.resume;
			$('#restart-btn').textContent=t.restart;
			$('#quit-btn').textContent=t.quit;
			$('#over-title').textContent=t.gameOver;
			$('#again-btn').textContent=t.again;
			$('#share-btn').textContent=t.share;
			$('#over-quit-btn').textContent=t.exit;
			$('#tip-text').textContent=t.tip;
			updateHudLabels();
			if(state.over) updateOverPanel();
		}
		function updateHudLabels(){
			const t=i18n[lang];
			$('#score-label').firstChild.textContent=t.score+': ';
			$('#high-label').firstChild.textContent=t.high+': ';
		}
		$$('.lang-switch button').forEach(btn=>btn.addEventListener('click',()=>{
			if(btn.dataset.lang===lang) return;
			lang=btn.dataset.lang;localStorage.setItem('gameLang',lang);
			$$('.lang-switch button').forEach(b=>b.classList.toggle('active',b.dataset.lang===lang));
			applyLang();
			flashMessage(i18n[lang].day+" / "+i18n[lang].night+" ✦",900);
		}));
		lang=localStorage.getItem('gameLang')||lang;$$('.lang-switch button').forEach(b=>b.classList.toggle('active',b.dataset.lang===lang));
		/* ============= Canvas & Game State ============== */
		const canvas=$('#game');
		const ctx=canvas.getContext('2d');
		let W=0,H=0,dp=1;function resize(){dp=window.devicePixelRatio||1;W=canvas.clientWidth;H=canvas.clientHeight;canvas.width=W*dp;canvas.height=H*dp;ctx.setTransform(dp,0,0,dp,0,0);}window.addEventListener('resize',resize);resize();
		const state={running:false,paused:false,over:false,frame:0,time:0,speed:420,baseSpeed:420,dist:0,score:0,high:parseInt(localStorage.getItem('dinoHighScore')||'0'),day:true,nextSwitch:15000,obstacles:[],particles:[],clouds:[],lastSpawn:0,spawnInterval:1400,jump:false,pressDown:false,dinoY:0,dinoV:0,gravity:1600,jumpVel:720,floor:0,combo:0};
		$('#high').textContent=state.high;
		/* ============== Utility ============== */
		const rand=(a,b)=>Math.random()*(b-a)+a;const irand=(a,b)=>Math.floor(rand(a,b));
		function flashMessage(txt,ms=1200,color){const el=$('#messages');el.textContent=txt; if(color) el.style.background=color; el.classList.add('show');clearTimeout(flashMessage._t);flashMessage._t=setTimeout(()=>el.classList.remove('show'),ms);}  
		/* ============== Entities ============== */
		class Obstacle{constructor(type){this.type=type;this.passed=false;this.w= type==='bird'? 62: irand(34,70);this.h= type==='bird'? irand(34,50):irand(50,90);this.x=W+20;this.y=H - state.floor - this.h; if(type==='bird'){this.y-= irand(0,80);this.flap=0;} }
			update(dt){this.x-=state.speed*dt; if(this.type==='bird'){this.flap+=dt*9;}}
			draw(){ctx.save();if(this.type==='cactus'){drawCactus(this.x,this.y,this.w,this.h);}else{drawBird(this.x,this.y,this.w,this.h,this.flap);}ctx.restore();}
			hitbox(){return {x:this.x+6,y:this.y+4,w:this.w-12,h:this.h-8};}
		}
		function drawGroundPattern(){const stripeH=18;const gY=H-state.floor;ctx.save();ctx.translate(0,gY);ctx.fillStyle= state.day? '#d9c7a2':'#3a2f25';ctx.fillRect(0,0,W,stripeH);ctx.fillStyle= state.day? '#c2b08b':'#2a221b';for(let i=0;i<W;i+=46){ctx.fillRect(i+irand(-2,2),-4,irand(18,32),8);}ctx.restore();}
		function drawCactus(x,y,w,h){ctx.save();ctx.translate(x,y);const grad=ctx.createLinearGradient(0,0,w,h);if(state.day){grad.addColorStop(0,'#7ed957');grad.addColorStop(1,'#2e7d32');}else{grad.addColorStop(0,'#66bb6a');grad.addColorStop(1,'#1b5e20');}ctx.fillStyle=grad;roundedRect(0,0,w,h,8);ctx.fill();ctx.fillStyle='rgba(255,255,255,.2)';for(let i=6;i<w-6;i+=12){ctx.fillRect(i,4,2,h-8);}ctx.restore();}
		function drawBird(x,y,w,h,flap){ctx.save();ctx.translate(x+w/2,y+h/2);const swing=Math.sin(flap*Math.PI)*8;ctx.fillStyle= state.day? '#4dabf5':'#90caf9';roundedRect(-w/2,-h/2,w,h,14);ctx.fill();ctx.fillStyle='#fff';roundedRect(w/6,-h/3,w/3,h/3,8);ctx.fill();ctx.fillStyle='#000';ctx.beginPath();ctx.arc(w/3,h*-0.15,3,0,6.28);ctx.fill();ctx.strokeStyle='rgba(0,0,0,.3)';ctx.beginPath();ctx.moveTo(-w/2+6,0);ctx.quadraticCurveTo(0,swing,w/2-6,0);ctx.lineWidth=8;ctx.lineCap='round';ctx.stroke();ctx.restore();}
		function roundedRect(x,y,w,h,r){ctx.beginPath();ctx.moveTo(x+r,y);ctx.lineTo(x+w-r,y);ctx.quadraticCurveTo(x+w,y,x+w,y+r);ctx.lineTo(x+w,y+h-r);ctx.quadraticCurveTo(x+w,y+h,x+w-r,y+h);ctx.lineTo(x+r,y+h);ctx.quadraticCurveTo(x,y+h,x,y+h-r);ctx.lineTo(x,y+r);ctx.quadraticCurveTo(x,y,x+r,y);}
		/* ============= Player (Dino) ============= */
		const dino={x:140,w:60,h:70,blink:0,eyeClosed:false};
		function updateDino(dt){state.dinoV+=state.gravity*dt;state.dinoY+=state.dinoV*dt;if(state.dinoY>0){state.dinoY=0;state.dinoV=0;} dino.blink+=dt;if(dino.blink>irand(2,6)){dino.eyeClosed=true;if(dino.blink> dino.eyeClosed? dino.blink+0.12:0)dino.blink=0,dino.eyeClosed=false;}}
		function jump(){if(state.dinoY===0){state.dinoV=-state.jumpVel;play('jump');}}
		function drawDino(){const baseY=H - state.floor - dino.h + state.dinoY;ctx.save();ctx.translate(dino.x,baseY);const bodyGrad=ctx.createLinearGradient(0,0,0,dino.h);bodyGrad.addColorStop(0,state.day?'#7bc56b':'#5da95a');bodyGrad.addColorStop(1,state.day?'#2e7d32':'#1e4620');ctx.fillStyle=bodyGrad;roundedRect(0,10,dino.w,dino.h-10,18);ctx.fill();ctx.fillStyle=state.day?'#6ab85d':'#4c8f4c';roundedRect(dino.w*0.55,0,dino.w*0.38,38,14);ctx.fill(); // head
			// eye
			ctx.fillStyle=dino.eyeClosed?'#2e462e':'#fff';ctx.beginPath();ctx.arc(dino.w*0.78,16,8,0,6.28);ctx.fill();ctx.fillStyle='#222';if(!dino.eyeClosed){ctx.beginPath();ctx.arc(dino.w*0.78,16,4,0,6.28);ctx.fill();}
			// legs
			const t=state.time*10;const phase=Math.sin(t)*6;ctx.fillStyle=state.day?'#2e7d32':'#1d4d1f';roundedRect(8,dino.h-26,16,26- state.dinoY*0.05,6);ctx.fill();ctx.save();ctx.translate(dino.w-24,dino.h-26);ctx.rotate(phase*0.05);roundedRect(-8,0,16,26- state.dinoY*0.05,6);ctx.fill();ctx.restore();
			ctx.restore();}
		function dinoHitbox(){return {x:dino.x+10,y:H - state.floor - dino.h + state.dinoY + 8,w:dino.w-18,h:dino.h-18};}
		/* ============= Clouds & Stars ============= */
		function spawnCloud(){state.clouds.push({x:W+ irand(0,200),y:rand(20,H*0.45),r:rand(24,70),s:rand(.1,.35)});} for(let i=0;i<6;i++)spawnCloud();
		function drawClouds(dt){ctx.save();state.clouds.forEach(c=>{c.x-= state.speed*0.15*dt; if(c.x<-c.r*2){c.x=W+rand(0,240);c.y=rand(20,H*0.5);c.r=rand(24,70);} const g=ctx.createRadialGradient(c.x,c.y,c.r*0.2,c.x,c.y,c.r); if(state.day){g.addColorStop(0,'rgba(255,255,255,.95)');g.addColorStop(1,'rgba(255,255,255,.1)');} else {g.addColorStop(0,'rgba(255,255,255,.8)');g.addColorStop(1,'rgba(255,255,255,.05)');} ctx.fillStyle=g;ctx.beginPath();ctx.arc(c.x,c.y,c.r,0,6.28);ctx.fill();});ctx.restore();}
		/* ============== Difficulty & Day/Night ============== */
		function updateDifficulty(dt){state.speed+=dt*4;state.dist+=state.speed*dt/100;const fill=Math.min(1,(state.speed-state.baseSpeed)/300);$('#difficulty .fill').style.width=(fill*100).toFixed(1)+'%'; if(state.time>state.nextSwitch){state.day=!state.day;document.body.classList.toggle('night',!state.day);state.nextSwitch=state.time+15000;flashMessage(state.day? i18n[lang].day: i18n[lang].night,1400);}}
		/* ============== Obstacle Spawning ============== */
		function spawnObstacle(){const type=Math.random()<0.25?'bird':'cactus';state.obstacles.push(new Obstacle(type));}
		/* ============== Collision ============== */
		function checkCollisions(){const d=dinoHitbox(); for(const o of state.obstacles){const h=o.hitbox(); if(h.x < d.x + d.w && h.x + h.w > d.x && h.y < d.y + d.h && h.y + h.h > d.y){gameOver(); return;} if(!o.passed && h.x + h.w < d.x){o.passed=true; state.score+=10; state.combo++; flashMessage(state.combo%5===0? i18n[lang].perfect:'+'+10,600); updateScore();}}}
		/* ============== Score & HUD ============== */
		function updateScore(){ $('#score').textContent=state.score; if(state.score>state.high){state.high=state.score;$('#high').textContent=state.high;localStorage.setItem('dinoHighScore',state.high);} }
		function updateOverPanel(){const t=i18n[lang]; $('#over-score-line').textContent=t.scoreLine(state.score,state.high); if(state.score>=state.high && state.score!==0) flashMessage(t.newHigh,1600,'linear-gradient(90deg,#ffb300,#ff7043)'); }
		/* ============== Loop ============== */
		let lastTs=0;function loop(ts){if(!state.running){lastTs=ts;return requestAnimationFrame(loop);} const dt=Math.min(.05,(ts-lastTs)/1000);lastTs=ts; state.frame++; state.time+=dt*1000; ctx.clearRect(0,0,W,H); drawClouds(dt); updateDino(dt); updateDifficulty(dt); // spawn
			if(state.time - state.lastSpawn> state.spawnInterval){spawnObstacle(); state.lastSpawn=state.time; state.spawnInterval= irand(900,1600);} // update + draw obstacles
			for(let i=state.obstacles.length-1;i>=0;i--){const o=state.obstacles[i];o.update(dt);o.draw(); if(o.x+o.w<-40) state.obstacles.splice(i,1);} drawGroundPattern(); drawDino(); checkCollisions(); // fps
			if(state.frame%12===0){const fps=(1/dt).toFixed(0);$('#fps').textContent=fps+' FPS';}
			if(state.running) requestAnimationFrame(loop);
		}
		requestAnimationFrame(loop);
		/* ============== Audio (minimal) ============== */
		let actx; function initAudio(){if(!actx){actx=new (window.AudioContext||window.webkitAudioContext)();}}
		function beep(freq,dur=0.12,vol=0.25,type='sine'){if(!actx)return;const o=actx.createOscillator();const g=actx.createGain();o.type=type;o.frequency.value=freq;o.connect(g);g.connect(actx.destination);g.gain.value=vol;o.start();o.stop(actx.currentTime+dur);}
		function play(name){switch(name){case 'jump':beep(520,0.14,0.25,'square');break;case 'over':beep(180,0.4,0.35,'sawtooth');setTimeout(()=>beep(120,0.5,0.3,'sawtooth'),120);break;case 'start':beep(600,0.08,0.2,'square');setTimeout(()=>beep(760,0.08,0.18,'square'),100);break;}}
		/* ============== Controls ============== */
		function startGame(){if(state.running) return; hideOverlay('#start-overlay'); hideOverlay('#over-overlay');$('#hud').classList.remove('hidden');$('#difficulty').classList.remove('hidden'); state.running=true; state.over=false;state.score=0;state.dist=0;state.speed=state.baseSpeed;state.obstacles.length=0;state.time=0;state.lastSpawn=0;state.spawnInterval=1400;state.dinoY=0;state.dinoV=0;state.combo=0;updateScore(); play('start'); flashMessage(i18n[lang].speedUp,900);}
		function pauseGame(){if(!state.running||state.over) return; state.paused=!state.paused; if(state.paused){state.running=false; showOverlay('#pause-overlay');} else {hideOverlay('#pause-overlay'); state.running=true; requestAnimationFrame(loop);} }
		function gameOver(){state.running=false;state.over=true; showOverlay('#over-overlay'); updateOverPanel(); play('over');}
		function showOverlay(sel){$(sel).classList.remove('hidden');}
		function hideOverlay(sel){$(sel).classList.add('hidden');}
		window.addEventListener('keydown',e=>{if(['Space','ArrowUp','KeyW'].includes(e.code)){e.preventDefault(); if(!state.running && !state.over){startGame();} else if(state.over){startGame();} else if(!state.paused){jump();} }
			else if(e.code==='KeyP' || e.code==='Escape'){pauseGame();}
		});
		window.addEventListener('keydown',e=>{ if(['ArrowDown','KeyS'].includes(e.code)){state.pressDown=true;} });
		window.addEventListener('keyup',e=>{ if(['ArrowDown','KeyS'].includes(e.code)){state.pressDown=false;} });
		// Touch controls
		let touchJumpZone=0; canvas.addEventListener('touchstart',e=>{initAudio(); if(!state.running){startGame(); return;} const x=e.changedTouches[0].clientX;touchJumpZone = x < window.innerWidth/2 ? 0:1; if(touchJumpZone===0){jump();} else {state.pressDown=true;} });
		canvas.addEventListener('touchend',()=>{state.pressDown=false;});
		$('#start-btn').addEventListener('click',()=>{initAudio();startGame();});
		$('#resume-btn').addEventListener('click',pauseGame); $('#restart-btn').addEventListener('click',()=>{hideOverlay('#pause-overlay');startGame();}); $('#quit-btn').addEventListener('click',()=>{hideOverlay('#pause-overlay');showOverlay('#start-overlay');state.over=false;});
	$('#again-btn').addEventListener('click',()=>location.reload()); $('#over-quit-btn').addEventListener('click',()=>{hideOverlay('#over-overlay');showOverlay('#start-overlay');});
		$('#toggle-theme').addEventListener('click',()=>{state.day=!state.day;document.body.classList.toggle('night',!state.day);});
		$('#share-btn').addEventListener('click',async()=>{const text=`${i18n[lang].title} - ${i18n[lang].score}: ${state.score}`; try{await navigator.share?.({text});flashMessage('✓',600);}catch{navigator.clipboard.writeText(text);flashMessage('Copied',800);} });
		/* ============== Init ============== */
		function init(){state.floor=54;document.body.classList.toggle('night',!state.day);applyLang();}
		init();
	})();
	</script>
</body>
</html>
